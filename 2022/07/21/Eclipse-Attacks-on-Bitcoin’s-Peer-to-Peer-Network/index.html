

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Shaoyu Li">
  <meta name="keywords" content="">
  
    <meta name="description" content="Eclipse Attacks on Bitcoin’s Peer-to-Peer Network Abstract Eclipse attacks on bitcoin’s peer-to-peer network: allows an adversary controlling a sufficient number of IP addresses to monopolize all conn">
<meta property="og:type" content="article">
<meta property="og:title" content="Eclipse-Attacks-on-Bitcoin’s-Peer-to-Peer-Network">
<meta property="og:url" content="http://example.com/2022/07/21/Eclipse-Attacks-on-Bitcoin%E2%80%99s-Peer-to-Peer-Network/index.html">
<meta property="og:site_name" content="The refreshing spring breeze bath">
<meta property="og:description" content="Eclipse Attacks on Bitcoin’s Peer-to-Peer Network Abstract Eclipse attacks on bitcoin’s peer-to-peer network: allows an adversary controlling a sufficient number of IP addresses to monopolize all conn">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-07-21T13:53:06.000Z">
<meta property="article:modified_time" content="2022-07-21T13:54:12.959Z">
<meta property="article:author" content="Shaoyu Li">
<meta property="article:tag" content="Bitcoin network attack">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>Eclipse-Attacks-on-Bitcoin’s-Peer-to-Peer-Network - The refreshing spring breeze bath</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.0","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>

  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Shaoyu Li&#39;s personal blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Eclipse-Attacks-on-Bitcoin’s-Peer-to-Peer-Network"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-07-21 09:53" pubdate>
          July 21, 2022 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          15k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          124 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Eclipse-Attacks-on-Bitcoin’s-Peer-to-Peer-Network</h1>
            
            <div class="markdown-body">
              
              <p>Eclipse Attacks on Bitcoin’s Peer-to-Peer Network</p>
<p>Abstract</p>
<p>Eclipse attacks on bitcoin’s peer-to-peer network: allows an adversary controlling a sufficient number of IP addresses to monopolize all connections to and from a victim bitcoin node.</p>
<p>Then 攻击者可以利用受害者来进行针对比特币挖矿和共识系统的攻击，包括 N 验证双花，自我挖矿，以及区块链对手分叉。最后，本文提出了一些对策（受僵尸网络架构启发），被设计来提升 eclipse 攻击的门槛，同时保护开放和去中心化的比特币当前网络架构。</p>
<p>\1. Introduction</p>
<p>比特币成功的关键原因是去中心化。</p>
<p>Blockchain: bitcoin uses a decentralized network of nodes that use computational proofs-of-work to reach consensus on a distributed public ledger of transactions.</p>
<p>比特币白皮书 argues that bitcoin is secure against attackers that seek to shift the blockchain to an inconsistent/incorrect state, as long as these attackers control less than half of the computational power in the network.</p>
<p>比特币安全的底层前提 perfect information：all members of the bitcoin ecosystem can observe the pow done by their peers.（每个人都要能观察到其他节点的 PoW 工作）</p>
<p>The bitcoin peer-to-peer network, which is bundled into the core bitcoind implementation, aka.,</p>
<p>the Satoshi client, is designed to be open, decentralized, and independent of a public-key infrastructure.(因此，比特币节点之间不需要密码学认证，节点被通过 IP 地址识别)</p>
<p>Each node uses a randomized protocol to select eight peers with which it forms long-lived outgoing connections, and to propagate and store addresses of other potential peers in the network. Nodes with public IPs also accept up to 117 unsolicited incoming connections from any IP address. Nodes exchange views of the state of the blockchain with their incoming and outgoing peers.（一个节点随机选择 8 个向外的连接，有最多 117 个向内的连接，向外连接可以广播潜在的网络节点）</p>
<p>Eclipse attack</p>
<p>An attacker monopolizes all of the victim’s incoming and outgoing connections, thus isolating the victim from the rest of its peers in the network. The attacker can then filter the victim’s view of the blockchain, force the victim to waste computer power on obsolete views of the blockchain, or use the victim’s power for its own purposes.</p>
<p>Off-path attacks: the attacker controls endhosts, but not the key network 架构 between the victim and the rest of the bitcoin network. The attack 快速并且重复产生未经请求的向内连接 to the victims from a set of endhosts at attacker-controlled IP addresses, sending bogus network information, and waiting until the victim restarts. Then victim forms all eight outgoing connections to attacker-controlled addresses, the attacker also 垄断受害者向内的 117 个连接。</p>
<p>攻击使用的是低速率的 TCP 连接，因此最大的挑战是获得足够数量的 IP 地址。有两种攻击模式，第一种是 infrastructure attacks 模型化了 ISP，公司或者国家级别的威胁，这些单位都持有一些 contiguous IP address blocks 并且寻找去推翻比特币通过攻击其 p2p 网络。第二种是 botnet attacks，加载在不同 IP 地址范围的僵尸主机上。</p>
<p>我们的攻击只针对拥有公开 IP 的节点。</p>
<p>对策：<br>
\1. disabling incoming connections</p>
<p>\2. choosing specific outgoing connections to well connected peers or known miners(whitelists)</p>
<p>这些对策有问题：如果向内的连接被 ban 了，新节点如何加入网络？一个节点如何决定 specific 节点，比特币节点是否应该形成一个私人网络？这是不是会破坏去中心化来允许挖矿攻击。</p>
<p>1.1 eclipse attack 的暗示</p>
<p>Engineering block races</p>
<p>受害者挖出来的块被攻击者屏蔽了，等到别人挖出来了，再释放这个块，因此，受害者的块会被抛弃。</p>
<p>Splitting mining power</p>
<p>Eclipse x 比例的矿工算力，可以变得简单来进行 mining attack。</p>
<p>Selfish mining</p>
<p>The attacker strategically withholds blocks to win more than its fair share of mining rewards. The attack’s success is parameterized by two values: α, the ratio of mining power controlled by the attacker, and γ, the ratio of honest mining power that will mine on the attacker’s blocks during a block race. If γ is large, then α can be small. By eclipsing miners, the attacker increases γ, and thus decreases α so that selfish mining is easier. To do this, the attacker drops any blocks discovered by eclipsed miners that compete with the blocks discovered by the selfish miners. Next, the attacker increases γ by feeding only the selfish miner’s view of the blockchain to the eclipsed miner; this coopts the eclipsed miner’s compute power, using it to mine on the selfish-miner’s blockchain.</p>
<p>0-confirmation double spend</p>
<p>To launch a double-spend attack against the merchant, the attacker eclipses the merchant’s bitcoin node, sends the merchant a transaction T for goods, and sends transaction TX double-spending those bitcoins to the rest of the network. The merchant releases the goods to the attacker, but since the attacker controls all of the merchant’s connections, the merchant cannot tell the rest of the network about T, which meanwhile</p>
<p>confirms TX.</p>
<p>N-confirmation double spend</p>
<p>In an N-confirmation transaction, a merchant releases goods only after the transaction is confirmed in a block of depth N−1 in the blockchain. The attacker sends its transaction to the eclipsed miners, who incorporate it into their (obsolete) view of the blockchain. The attacker then shows this view of blockchain to the eclipsed merchant, receives the goods, and sends both the</p>
<p>merchant and eclipsed miners the (non-obsolete) view of blockchain from the non-eclipsed miners. The eclipsed miners’ blockchain is orphaned, and the attacker obtains goods without paying.</p>
<p>2.Bitcoin’s peer to peer Network</p>
<p>A node with a public IP can initiate up to eight outgoing connections with other bitcoin nodes, and accept up to 117 incoming connections. A node with a private IP only initiates eight outgoing connections. Connections are over TCP. Nodes only propagate and store public IPs; a node can determine if its peer has a public IP by comparing the IP packet header with the bitcoin VERSION message. A node can also connect via Tor; we do not study this, see</p>
<p>[BIRYUKOV, A., KHOVRATOVICH, D., AND PUSTOGAROV, I.Deanonymisation of clients in Bitcoin P2P network. In Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications Security (2014), ACM, pp. 15–29.</p>
<p>BIRYUKOV, A., AND PUSTOGAROV, I. Bitcoin over tor isn’t a good idea. arXiv preprint arXiv:1410.6079 (2014).] instead.</p>
<p>2.1 propagating network information</p>
<p>how nodes propagate and store network information, and how they select outgoing connections?</p>
<p>DNS seeder: A DNS seeder 是一个服务器，用来响应来自比特币节点的 DNS 查询 with a list of IP addresses for bitcoin nodes. 它获得这些地址：周期性爬取比特币网络。比特币网络有六个 seeders，被查询仅仅在两种情况。首先，当一个新节点第一次加入网络，这个节点尝试连接 seeders 来获得一些活跃的 IP 地址列表，否则失败转移到一个硬编码列表有大约 600 个 IP 地址。第二个是当一个存在的节点重启并且重新连接到一个新的节点，自从这个节点开始尝试建立链接后的 11 秒并且节点有小于两个外在连接，the seeder 会被查询。</p>
<p>ADDR message: 包含最大 1000 个 IP 地址并且他们的时间戳，被用于从节点获得网络信息。节点接受主动提供的 ADDR message。一个 addr 消息被索求仅仅通过建立一个往外的连接 with a peer. 这个节点响应 with 最大 3 个 addr messages 每个包括最大 1000 个 IP 地址随机从表中选择。节点推动 ADDR messages 在两种情况下：1. 每天一个节点发送他自己的 IP 地址在一个 ADDR 消息给每一个节点。2. 当一个节点收到一个 ADDR 消息不超过 10 个地址，他往前转移 ADDR 消息给两个随机选择的连接节点。</p>
<p>2.2 storing network information</p>
<p>Public IPs are stored in a nodes’ two tables: tried tables and new tables.</p>
<p>Tables are stored in the disk and persist when a node restarts.</p>
<p>The tried table: consists of 64 buckets, each bucket can store up to 64 unique addresses for peers to whom the node has successfully established an incoming or outgoing connection (已经成功建立连接的，可以放在 tried 表里面). 节点存储时间戳，时间戳为和这个节点的最近的成功连接的时间。</p>
<p>每个节点的地址被 mapped 到一个 bucket in tried 通过计算哈希值：1.IP 地址 2.group，where the group is defined in the /16 IPv4 prefix containing 节点的 IP 地址。每一个 IP 地址匹配到一个单独的 bucket in tried，并且每一个 group maps to up to four buckets. 因此，每个 IP 地址都匹配到一个单独的 bucket in tried，并且每一个 group maps 最多四个 buckets。</p>
<p>当一个节点成功连接到一个 peer，节点的地址被插入进一个合适的 tried bucket。如果这个 bucket 满了，包括 64 个地址，然后 bitcoin eviction（比特币驱逐） 被使用：四个地址从 buckets 中被随机选择，最老的（1）被新的 peer address 在 tired 代替（2）被插入到 new table。如果这个节点已经在 bucket 中，相关的时间戳会被更新。时间戳依然会被更新：an actively connected peer sends a VERSION, ADDR, INVENTORY, GETDATA or PING message and more than 20 minutes elapsed since the last update（连接的节点过了 20 分钟再发消息）.</p>
<p>The new table: consists of 256 buckets, each of which can hold up 64 addresses for peers to whom the nodes has not initiated a successful connection. A node populates the new table with information learned from the DNS seeders, or from ADDR messages.（已经知道了这些地址，但是还没有链接）</p>
<p>Every address a inserted in new belongs to (1) a group, defined in our description of the tried table, and (2) a source group, the group that contains the IP address of the connected peer or DNS seeder from which the node learned address.</p>
<p>Each (group, source group) pair hashes to a single new bucket, while each group selects up to 32 buckets in new. Each bucket holds unique addresses. If a bucket is full, then a function called isTerrible is run over all 64 addresses in the bucket; if any one of the addresses is terrible, in that it is (a) more than 30 days old, or (b) has had too many failed connection attempts, then the terrible address is evicted in favor of the new address; otherwise, bitcoin eviction (bitcoin eviction（比特币驱逐）：四个地址从 buckets 中被随机选择，最老的（1）被新的 peer address 在 tired 代替（2）被插入到 new table。) is used with the small change that the evicted address is discarded.</p>
<p>2.3 selecting peers</p>
<p>1. 确定选哪个表</p>
<p>2. 确定 buckets 以及地址，偏向选 fresh 的地址</p>
<p>3. 连接</p>
<p>\3. The Eclipse Attack</p>
<p>New outgoing connections are selected if a node restarts or if an outgoing connection is dropped by the network. A bitcoin node never deliberately drops a connection, except when a blacklisting condition is met (e.g., the peer sends ADDR messages that are too large).</p>
<p>Our attack is for a victim with a public IP. Our attacker (1) populates the tried table with addresses for its attack nodes, and (2) overwrites addresses in the new table with “trash” IP addresses that are not part of the bitcoin network. The “trash” addresses are unallocated(e.g., listed as “available” by [RIPE. Latest delegations. <a href="ftp://ftp.ripe.net/pub/stats/">ftp://ftp.ripe.net/pub/stats/</a></p>
<p>ripencc/delegated-ripencc-extended-latest, 2015.]) or as “reserved for future use” by</p>
<p>[IANA.Iana ipv4 address space registry. <a target="_blank" rel="noopener" href="http://www.iana.org/assignments/ipv4-address-space/ipv4-address-space.xhtml">http://www.iana.org/assignments/ipv4-address-space/ipv4-address-space.xhtml</a>, January 2015.] (e.g., 252.0.0.0/8). We ﬁll new with “trash” because, unlike attacker addresses, “trash” is not a scarce resource. The attack continues until (3) the victim node restarts and chooses new outgoing connections from the tried and new tables in its persistant storage (Section 2.3). With high probability, the victim establishes all eight outgoing connections to attacker addresses; all eight addresses will be from tried, since the victim cannot connect to the “trash” in new. Finally, the attacker (5) occupies the victim’s remaining 117 incoming connections. We now detail each step of our attack.</p>
<p>3.1 Populating tried and new</p>
<p>\1. Addresses from unsolicited incoming connections are stored in the tried table; thus, the attacker can insert an address into the victim’s tried table simply by connecting to the victim from that address. Moreover, the bitcoin eviction discipline means that the attacker’s fresher addresses are likely to evict any older legitimate addresses stored in the tried table.</p>
<p>\2. A node accepts unsolicited ADDR messages; these addresses are inserted directly into the new table without testing their connectivity. Thus, when our attacker connects to the victim from an adversarial address, it can also send ADDR messages with 1000 “trash” addresses. Eventually, the trash overwrites all legitimate addresses in new. We use “trash” because we do not want to waste our IP address resources on overwriting new.</p>
<p>\3. Nodes only rarely solicit network information from peers and DNS seeders. Thus, while the attacker overwrites the victim’s tried and new tables, the victim almost never counteracts the flood of adversarial information by querying legitimate peers or seeders.</p>
<p>3.2 Restarting the victim</p>
<p>Our attack requires the victim to restart so it can connect to adversarial addresses. There are several reasons why a bitcoin node could restart, including ISP outages, power failures, and upgrades, failures or attacks on the host OS; indeed, [16] found that a node with a public IP has a 25% chance of going offline after 10 hours. Another predictable reason to restart is a software update.</p>
<p>3.3 selecting outgoing connections</p>
<p>Our attack succeeds if, upon restart, the victim makes all its outgoing connections to attacker addresses.</p>
<p>\1. An f-fraction of the addresses in the victim’s tried table are controlled by the adversary and the remaining 1− f-fraction are legitimate.</p>
<p>\2. All addresses in new are “trash”; all connections to addresses in new fail, and the victim is forced to connect to addresses from tried.</p>
<p>\3. The attack proceeds in rounds, and repeats each round until the moment that the victim restarts. During a single round, the attacker connects to the victim from each of</p>
<p>its adversarial IP addresses. A round takes time τa, so all adversarial addresses in tried are younger than τa.（每一轮都让自己的对手节点发起攻击，每一轮需要时间 ta，所以每个节点的时间都小于 ta）</p>
<p>\4. An f‘-fraction addresses in tried are actively connected to the victim before the victim restarts. The timestamps on these legitimate addresses are updated every 20 minute or more. We assume these timestamps are fresh (i.e., τ = 0) when the victim restarts; this is the worst case for the attacker.</p>
<p>\5. The time invested in the attack τt is the time elapsed from the moment the adversary starts the attack, until the victim restarts. If the victim did not obtain new legitimate network information during of the attack, then, excluding the f’-fraction described above, the legitimate addresses in tried are older than τt.</p>
<p>3.4 Monopolizing the eclipse victim</p>
<p>The victim has exactly eight outgoing connections; all we require in terms of incoming</p>
<p>connections is that the victim has a few open slots to accept incoming TCP connections from the attacker.</p>
<p>While it is often assumed that the number of TCP connections a computer can make is limited by the OS or the number of source ports, this applies only when OS-provided TCP sockets are used; a dedicated attacker can open an arbitrary number of TCP connections using a custom TCP stack. A custom TCP stack (see e.g.,zmap [35]) requires minimal CPU and memory, and is typically bottlenecked only by bandwidth, and the bandwidth cost of our attack is minimal:</p>
<p>Attack connections. To fill the tried table, our attacker repeatedly connects to the victim from each of its addresses. Each connection consists of a TCP hand-shake, bitcoin VERSION message, and then disconnection via TCP RST; this costs 371 bytes upstream and 377 bytes downstream. Some attack connections also send one ADDR message containing 1000 addresses; these ADDR messages cost 120087 bytes upstream and 437</p>
<p>bytes downstream including TCP ACKs.</p>
<p>Monopolizing connections. If that attack succeeds, the victim has eight outgoing connections to the attack nodes, and the attacker must occupy the victim’s remaining incoming connections. To prevent others from connecting to the victim, these TCP connections could be maintained for 30 days, at which point the victim’s address is terrible and forgotten by the network. While bitcoin supports block inventory requests and the sending of blocks and transactions, this consumes significant bandwidth; our attacker thus does not to respond to inventory requests. As such, setting up each TCP connection costs 377 bytes upstream and 377 bytes downstream, and is maintained by ping-pong packets and TCP ACKs consuming 164 bytes every 80 minutes.</p>
<p>We experimentally confirmed that a bitcoin node will accept all incoming connections from the same IP address. (We presume this is done to allow multiple nodes behind a NAT to connect to the same node.)</p>
<p>\8. Related work</p>
<p>How Bitcoin’s network can delay or prevent block propagation:</p>
<p>DECKER, C., AND WATTENHOFER, R. Information propagation in the bitcoin network. In IEEE Thirteenth International Conference on Peer-to-Peer Computing (P2P) (2013), IEEE, pp. 1–10.</p>
<p>Bitcoin network is used to deanonymize bitcoin users:</p>
<p>BIRYUKOV, A., KHOVRATOVICH, D., AND PUSTOGAROV, I.Deanonymisation of clients in Bitcoin P2P network. In Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications Security (2014), ACM, pp. 15–29.</p>
<p>BIRYUKOV, A., AND PUSTOGAROV, I. Bitcoin over tor isn’t a good idea. arXiv preprint arXiv:1410.6079 (2014).</p>
<p>KOSHY, P., KOSHY, D., AND MCDANIEL, P. An analysis of anonymity in bitcoin using p2p network trafﬁc. In Financial Cryptography and Data Security. 2014.</p>
<p>Other work has mapped bitcoin peers to autonomous systems</p>
<p>[FELD, S., SCH ¨ONFELD, M., AND WERNER, M. Analyzing the deployment of bitcoin’s p2p network under an as-level perspective. Procedia Computer Science 32 (2014), 1121–1126.],</p>
<p>geolocated peers and measured churn</p>
<p>[DONET, J. A. D., P´EREZ-SOLA, C., AND HERRERAJOANCOMART´I, J. The bitcoin p2p network. In Financial Cryptography and Data Security. Springer, 2014, pp. 87–102.],</p>
<p>and used side channels to learn the bitcoin network topology</p>
<p>[MILLER, A., LITTON, J., PACHULSKI, A., GUPTA, N., LEVIN,D., SPRING, N., AND BHATTACHARJEE, B. Discovering bitcoin’s network topology and inﬂuential nodes. Tech. rep., University of Maryland, 2015.].</p>
<p>[ROSSOW, C., ANDRIESSE, D., WERNER, T., STONE-GROSS,B., PLOHMANN, D., DIETRICH, C. J., AND BOS, H. Sok:P2pwned-modeling and evaluating the resilience of peer-to-peer botnets. In IEEE Symposium on Security and Privacy (2013), IEEE, pp. 97–111.]</p>
<p>finds that many botnets, like bitcoin, use unstructured peer-to-peer networks and gossip (i.e., ADDR messages), and describes how botnets defend against attacks that flood local address tables with bogus information. The Sality botnet refuses to evict “high-reputation” addresses; our anchor countermeasure is similar</p>
<p>Wüst &amp; Gervais. Ethereum Eclipse Attacks. 2016</p>
<p>Apostolaki et al. Hijacking Bitcoin: Routing Attacks on Cryptocurrencies. S&amp;P 2017.</p>
<p>Yuval et al. Low-Resource Eclipse Attacks on Ethereum’s Peer-to-Peer Network. 2018.</p>

              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Research/" class="category-chain-item">Research</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Bitcoin-network-attack/">#Bitcoin network attack</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Eclipse-Attacks-on-Bitcoin’s-Peer-to-Peer-Network</div>
      <div>http://example.com/2022/07/21/Eclipse-Attacks-on-Bitcoin’s-Peer-to-Peer-Network/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Shaoyu Li</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>July 21, 2022</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>Licensed under</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/06/21/HyperService/" title="HyperService">
                        <span class="hidden-mobile">HyperService</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;Table of Contents</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>






  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
